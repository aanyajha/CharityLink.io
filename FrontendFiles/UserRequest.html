<!DOCTYPE html>
<html>
<title>Make a Request</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<body>

<style>
img {
      max-width: 100%;
      height: auto;
    }
	.address {
  display: none;
}
</style>

  <div class="w3-sidebar w3-bar-block w3-card w3-animate-right" style="display:none;right:0;" id="mySidebar">

    <button onclick="closeNav()" class="w3-bar-item w3-button w3-large">&#10005; Close</button>

    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles" class="w3-bar-item w3-button">&#x27B2; Logout</a>
    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/DefaultDashboard" class="w3-bar-item w3-button">Dashboard</a>
    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/BrowseCatalog" class="w3-bar-item w3-button">Browse Catalog</a>
    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/UserEvents" class="w3-bar-item w3-button">Events Near Me</a>
    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/ViewRequests" class="w3-bar-item w3-button">View Requests</a>
     <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/ViewProfiles" class="w3-bar-item w3-button">View Organization Profiles</a>
     <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/Deliver" class="w3-bar-item w3-button">Make a Delivery</a>
    <a href="https://aanyajha.github.io/CharityLink.io/FrontendFiles/UserSettings" class="w3-bar-item w3-button">&#9965; Settings</a>
    <a href="https://aanyajha.github.io/CharityLink.io" class="w3-bar-item w3-button"><img src="https://i.postimg.cc/Zq3dkdkW/Charitylink-Logo-Updated.png" alt="Charity Link Logo" width="200" height="65"></a>
  </div>

  <div class="w3-pale-blue">
    <button class="w3-button turquoise w3-xlarge w3-right" onclick="openNav()">&#9776;</button>
    
  </div>
  
  <div class="w3-pale-blue">
  <div class="w3-container">
      <h1 style="color: #009999">Make a Request</h1>
      
      </div>
  </div>

  <div class="w3-container">
    <p>Welcome to Make a Request!</p>
    <p>Here you can request items that can be then be accepted and delivered by other users or an organization.</p>
    <hr style="height: 3px;"/>
  </div>
	
<body>
  <div class="w3-container">
  <label>Item Name:</label>
  <input type="text" id="name"><br><br>

  <label>Hashtags:</label>
  <input type="text" id="hashtags"><br><br>

  <label for="quantity">Quantity (between 1 and 10):</label>
  <input type="number" id="quantity" name="quantity" min="1" max="10">

  <br>
  <br>
  <br>

  <input type="radio" id="ftf" name="del-option">
  <label>Face-to-face</label>
  <input type="radio" id="delivery" name="del-option">
  <label>Delivery</label>
  <input type="radio" id="public" name="del-option" value="Public Meeting">
  <label>Public Meeting</label>

  <br><br>

  <input type="radio" id="use-old" name="address" onclick="oldAddr()">
  <label>Use Saved Address</label>
  <input type="radio" id="use-new" name="address" onclick="newAddr()">
  <label>Use New Address</label>

  <br><br>

  <label class="address">Address 1:</label>
  <input type="text" id="addr1" class="address">
  <label class="address">Address 2:</label>
  <input type="text" id="addr2" class="address">
  <label class="address">City:</label>
  <input type="text" id="city" class="address">
  <label class="address">State:</label>
  <input type="text" id="state" class="address">
  <label class="address">ZIP Code:</label>
  <input type="text" id="zip" class="address">
  <br>
  <button id="submitButton" onclick="check()">
    Submit
  </button>
</div>

</body>
	
	

</body>

<script>
	
function mainSubmit(locID) {
	//this is where we implement new request functionality
  //send api request for a new item creation


}

function oldAddressFunc() {

  //add the code from location to this
  var userData = JSON.parse(sessionStorage.getItem('userData'));

  if (userData.locationID == -1) {
    alert("You do not have a saved location. Change this in your settings.");
    return;
  }

  mainSubmit(userData.locationID);

}

function newAddressFunc() {
  //add the code from location to this

  var userData = JSON.parse(sessionStorage.getItem('userData'));

  var addr1 = document.getElementById("addr1").value;
  var addr2 = document.getElementById("addr2").value;
  var city = document.getElementById("city").value;
  var state = document.getElementById("state").value;
  var zip = document.getElementById("zip").value;

  if (addr1.length == 0 || city.length == 0 || state.length == 0 || zip.length == 0) {
    alert("Please fill out all of the following: Address 1, city, state, and zip code.");
    return;

  }

  //this is the start of api functionality for location, copied from our settings
  //TODO: FIXME (basically doesn't work because we don't know how we're gonna implement it yet)
  

  const locxhr = new XMLHttpRequest();
  var locurl = "";

  if (addr2.length == 0) {
    locurl = `http://172.174.33.35:8080/api/location/add?addressLine1=${addr1}&city=${city}&state=${state}&zip=${zip}`;
  } else {
    locurl = `http://172.174.33.35:8080/api/location/add?addressLine1=${addr1}&addressLine2=${addr2}&city=${city}&state=${state}&zip=${zip}`;
  }

  locxhr.open("POST", locurl, true);
  locxhr.send();
  locxhr.onload = function() {
    var locationId = this.responseText;
    if (this.status === 200) {
      mainSubmit(locationId);
    }
  }

  
}


function check() {

  //this function is used to check if everything is valid
  //so Varun's server doesn't die

  var name = document.getElementById("name").value;
  var desc = document.getElementById("description").value;

  var ftf = document.getElementById("ftf");
  var deli = document.getElementById("delivery");
  var public = document.getElementById("public");

  var oldAddress = document.getElementById("use-old");
  var newAddress = document.getElementById("use-new");

  if (name.length == 0 || desc.length == 0) {
    alert("Fill in all input fields.");
    return -1;
  }
  if (!ftf.checked && !deli.checked && !public.checked) {
    alert("Fill in all input fields.");
    return -1;
  }
  if (!oldAddress.checked && !newAddress.checked) {
    alert("Fill in all input fields.");
    return -1;
  }

  if (oldAddress.checked) {
    newAddressFunc();
  } else if (newAddress.checked) {
    oldAddressFunc();
  }

}


function newAddr() {

  var addrClass = document.getElementsByClassName("address");
  for (var i = 0; i < addrClass.length; i++) {
    addrClass[i].style.display = "inline";
  }

}

function oldAddr() {
  var addrClass = document.getElementsByClassName("address");
  for (var i = 0; i < addrClass.length; i++) {
    addrClass[i].style.display = "none";
  }
}

	
	
	
	
	
		function openNav() {
      document.getElementById("mySidebar").style.display = "block";
    }

    function closeNav() {
      document.getElementById("mySidebar").style.display = "none";
    }
    
    const userData = sessionStorage.getItem('userData');
    
    //const usernameTitle = userData.username;
    
    //document.getElementById("docTitle").innerHTML = "title" + ${usernameTitle};
   	
</script>

</html>
